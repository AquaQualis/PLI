<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<title>About the Iron Spring PL/I Library [OS/2]</title>
</head>
<body>
<h1>About the Iron Spring PL/I Library [OS/2]</h1>
The Iron Spring PL/I Library is copyright Iron Spring Software, 2023<p>
The complete library is released under the terms of the 
<a href="lib\lgpl.html">Gnu Lesser General Public License (LGPL)</a>
<p>
No library manager is shipped with with standard OS/2 Warp 4 or
its toolkit.
As a convenience to users who might want to modify or extend the library,
an unmodified executable of the Open Watcom&reg; Library Manager (wlib.exe)
is included.
<blockquote><pre>
Portions Copyright (c) 1984-2002 Sybase, Inc. All Rights Reserved.
Source code is available under the Sybase Open Watcom Public License.
See <a href="http://www.openwatcom.org/">http://www.openwatcom.org/</a> for details.
</pre></blockquote>
The text of the complete license for Open Watcom software is <a href="lib\OpenWatcom_License.html">included</a>.

<p>
In the following, &lt;release&gt; represents the current release.  For this
version that is pli-1.3.1.
<p>
This document describes the details of the OS/2 version of the library.  
For the Linux version see <a href="./library_linux.html">library_linux</a>.

<p>
The supplied makefile will build a static object library in &lt;release&gt;\lib\static\prf.lib,
and a DLL and import library in &lt;release&gt;\lib\prf.dll and &lt;release&gt;\lib\prf.lib.
<p>
The complete library sources are found in &lt;release&gt;\lib\source (PL/I source code),
&lt;release&gt;\lib\source\asm (OS-independent assembler source code and includes), and &lt;release&gt;\lib\include
(PL/I include files).
Operating system dependent sources are in &lt;release&gt;\lib\source\OS2 and &lt;release&gt;\lib\source\linux  To modify the library, make your changes to the
source, <b>cd</b> to &lt;release&gt;\lib, and type <b>make os2</b>.  The makefile is built for Gnu make
and compatibles, it currently will not work with wmake.
<p>
To add a procedure to the library, after coding the source, you need to add its entry to
&lt;release&gt;\lib\prf.def for the import library.  Ordinals 250 and up are expected to be 
available for user procs.  You will also need to add the object file name to
&lt;release&gt;\lib\prf.lbc, the command file for wlib.<p>
The startup procedure "_pli_Start" (&lt;release&gt;\lib\asm\plistart.asm) needs to be linked 
with the main procedure, and references the external symbol "_pli_Main", which is defined for each
OPTIONS(MAIN) procedure.  To simplify linking, a copy of this code is stored in the import library.  
Since "_pli_Main" is not defined in the library code, a dummy module 
(&lt;release&gt;\lib\OS2\dummy.asm)
is linked into the DLL to provide its resolution.  plistart is stored in the static library with
the other runtime procedures, and no dummy is required.
<p>
Since the compiled PL/I code specifies the library to be linked (prf.lib), both the import library
and the DLL have the same name.  The &lt;release&gt;\samples directory gives an example of how to
choose the desired library.
<p>
The directory &lt;release&gt;\lib\include contains definitions of the data areas used by the library, with descriptive 
comments.  The following might be of particular interest:
<dl>
<dt>desc.inc<dd>Definitions of PL/I "data descriptor" formats.
<dt>dsa.inc<dd>The PL/I standard stack frame header for a procedure or BEGIN-block.
<dt>fcb.inc<dd>The PL/I "file control block".
<dt>gbl.inc<dd>Global data used by PL/I program and library.  Note the this control block
contains eight bytes reserved for user data.
<dt>plitabs.inc<dd>The definition of the stream output "tabs" control block.  This is intended for
the use of user programs.<br>
See the IBM PL/I for MVS and VM Programmers' Guide for a description of PLITABS.
<dt>xcpt.inc<dd>Definitions of hex values and text descriptions of OS/2 system exceptions.
</dl>
<hr width="25%">
<p>
Iron Spring PL/I version 1.3.1, 15 Aug 2024.

</body>
</html>

