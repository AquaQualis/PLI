<html>
<title>Iron Spring PL/I Compiler Release Notes - Linux version 1.3.1</title>
<table border=0>
<tr><td width="25%"><img src="islogo.gif"></td>
<td>
<h1>Iron Spring PL/I Compiler</h1>
<h2>Linux Version 1.3.1<br>15 Aug 2024</h2>
<h3>Release Notes</h3>
</td></tr></table>

<ul>
<li><a href="#intro">Introduction</a>
<li><a href="#lic">License</a>
<li><a href="#cont">Contents of distribution</a>
<li><a href="#req">Requirements</a>
<li><a href="#rest">Restrictions</a>
<li><a href="#inst">Installation</a>
<li><a href="#samp">Sample Programs</a>
<li><a href="#use">Using the compiler</a>
<li><a href="#link">Linking PL/I programs</a>
<li><a href="#b64">64-bit Linux Considerations</a>
<li><a href="#doc">Documentation</a>
<li><a href="#fix">Bugs fixed in the current version</a>
<li><a href="#lib">Modifying the Runtime Library</a>
<li><a href="#bug">Reporting bugs</a>
</ul>

<a name="intro">
<p>
<h4>Introduction</h4>
This document provides information on using the Iron Spring PL/I compiler
and compiled programs on the Linux platform.  For information on the
OS/2 platform, see the corresponding document 
<a href="./readme_os2.html">readme_os2</a>. 
<p>
The current version still contains bugs.  
You can help improve the compiler.  See the section 
<a href="#bug">Reporting bugs</a>.

<p>
<b>Trademarks</b><br>
ArcaOS is a trademark of Arca Noae.<br>
Gnu is a trademark of the Free Software Foundation.<br>
IBM is a trademark of IBM, Inc.<br>
Intel is a trademark of Intel Corporation.<br>
Iron Spring is a trademark of Iron Spring Software.<br>
Linux is a registered trademark of Linus Torvalds.<br>
VAX is a trademark of Hewlett-Packard, Inc.<br>
WATCOM is a trademark of Sybase, Inc. and its subsidiaries.<br>
Library heap manager based on code 
Copyright (c) 2001-2006 Wolfram Gloger.<br>

<!----- License ------ -->
<a name="lic">
<p>
<h4>License</h4>
&lt;boring-legal-stuff&gt;<br>
This license a legal agreement between you and Iron Spring Software.  Your use of 
this software signifies that you agree to the terms of this license.
<p>
Iron Spring Software grants you the right to use and copy the Iron
Spring PL/I compiler and library freely.  You may distribute  programs compiled
using the compiler and/or linked with the library under any terms you wish 
without restriction.
The source to the library is licensed under the terms of the
<a href="lgpl.html">Gnu Lesser General Public License (LGPL)</a>.
<p>
All material is copyright Iron Spring Software, 2023.
<p>
THE COMPILER AND LIBRARY ARE PROVIDED "AS IS"
WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND
FITNESS FOR A PARTICULAR PURPOSE. THE ENTIRE RISK AS TO THE QUALITY AND
PERFORMANCE OF THE COMPILER AND LIBRARY IS WITH YOU. SHOULD THEY PROVE
DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING, REPAIR OR
CORRECTION.<br>
&lt;/boring-legal-stuff&gt;<br>

<!----- Contents --- -->
<a name="cont">
<p>
<h4>Contents</h4>
This distribution includes the executable for the PL/I compiler plic, 
the static library lib/static/libprf.a,
and the sources for the library and sample programs.
<pre><tt>
  pli-1.3.1
    |
    +-----------------------samples----------------lib
    |                          |                    |
 plic                       (Sample sources and     +--------------------------static---include----source-----------alt
 (compiler executable)       %include files,                                   |         |         |                 | 
 (documentation, etc.)       sample makefiles                                  |         |         +--------asm      |
                             and module definition                             |         |   (PL/I source)   |     (alt storage   
                             file).                                            |         |               (assembler management)
                                                                               |  (%include files          source)
                                                                               |    required by                                                                                      
                                                                               |     library).
                                                                               |
                                                                     libprf.a (static library)
</tt></pre>         


<!----- Requirements --- -->
<a name="req">
<p>
<h4>Requirements</h4>
The folowing software is required to run the Linux version of the compiler:
<ul>
<li>Linux.  PL/I should be distro-agnostic.  Testing was done on Fedora 17 (Beefy Miracle)
 - Kernel version 3.5.  At least a 2.6 kernel is required for multitasking.<br>
Running under Windows WSL2 may work, but has not been tested.

<li>GNU <a href="http://ftp.gnu.org/gnu/binutils/binutils-2.20.1.tar.bz2">Binutils</a>
 - a collection of tools including a linker (ld), and an archive utility (ar).
</ul>
The following software is recommended:
<ul>
<li>The gnu C library glibc (32-bit).  This may have been provided with your system.
PL/I programs can be linked either with or without libc.  
The gnu C compiler gcc is recommended to drive the linker when linking with libc. 
<li>The <a href="http://sourceforge.net/projects/jwasm/">JWASM</a> assembler - necessary only to rebuild the assembler pieces of the
runtime library. 
<li>Gnu <a href="http://ftp.gnu.org/pub/gnu/make/make-3.81.tar.gz">make</a>.<br>
<li>The <a href="http://www.gnu.org/software/gdb/download/">gdb</a> debugger.
</ul>

<!----- Restrictions ----->
<a name="rest">
<p>
<h4>Restrictions</h4>
Version 1.3.1 has a number of restrictions.  The most
significant are:
<ul>
<li>The compiler cannot yet generate position-independent code (PIC) required
to build shared objects.  As a result, only static linking to the PL/I
library is available.
</ul>

<!----- Installation --- -->
<a name="inst">
<p>
<h4>Installation</h4>
<ol>
<li>The distribution file is supplied as a gzipped tar file.
Unpacking it will create a directory named "pli-1.3.1".  
<li>Only the compiler (pli-1.3.1/plic) and the static 
runtime library (pli-1.3.1/lib/libprf.a) are required.
<li>Move the compiler to a directory in your $PATH such as /usr/bin,
and move libprf.a to a directory such as /usr/lib.
Alternatatively, you can specify which directory the library 
is in in your makefiles.
<br>
An installation procedure is provided.  cd to the 'pli-1.3.1' directory
and type 'make install' (with suitable authority).  This procedure moves the 
compiler to '/usr/bin' and creates a symlink 'plic' referencing it,
and moves the library to '/usr/lib' and creates the symlink
'libprf.a'.
</ol> 
<p>
A later version will be installable using one or more of the standard package managers.

<!----- Samples --- -->
<a name="samp">
<p>
<h4>Sample Programs</h4>

The file <a href="samples/samples.html">samples/samples.html</a> contains instructions
and a list of all the sample programs.  The comments in each program contain 
information on using the program.
<ol>
<li>Test the sample programs.  In this release only static linking is supported.
CD to the directory "pli-1.3.1/samples"
and type "make -f Makefile.Linux" without the quotes, case is significant..
The sample programs "numwrd", "filedump", "libver", "print_listing", and "task" 
build to executables, the remainder should  generate object files.
<li>Test numwrd. Enter "./numwrd 123".  The program should display
the result "one hundred twenty-three".
<li>You might want access to the %INCLUDE files in "pli-1.3.1/lib/include"
or "pli-1.3.1/samples" for your own programming.
</ol>

<!----- Using --- -->
<a name="use">
<p>
<h4>Using the compiler</h4>
The "samples" directory contains three sample makefiles that can be used to compile and link
PL/I programs.  You should copy these and modify them for your requirements.
"LC_make" and "LCC_make" both use gcc to drive the linker; the program entry will be libc's 
"_start".  "SA_make" calls ld directly and should be used only for programs that don't call 
any C functions.  The program entry will be PL/I's "main".  In all cases the static PL/I
runtime linkary "libprf.a" is required, indicated by "-lprf" in the linker command.
<ul>
<li>
Compiled PL/I programs have no external dependencies.  If no calls are made to functions
coded in the C language the only library required is the PL/I runtime library 'libprf.a'.
The sample makefile 'SA_make' compiles a PL/I program and links without referencing libc.
<li>
If any C functions are called, the PL/I program should be linked with libc; the sample
makefile 'LC_make' compiles a PL/I program and uses the Gnu C Compiler (gcc) to link it.
It is possible to link with ld, but using gcc eliminates libc version dependencies.
<li>
The PL/I library includes its own heap storage management.  Programs linked with libc
can use libc's heap management for both PL/I and C storage, or can use separate heaps
for the PL/I and C portions.  As distributed the library will use separate heaps.
Versions of allocate and release are provided in the directory pli-1.3.1/lib/alt
will use C's malloc and free.  The sample makefile 'LCC_make' shows how to link these 
procedures.
</ul>
<p> 
The <a href="prog_guide.html"><i>Iron Spring PL/I Compiler Programming Guide</i></a> describes 
the PL/I compiler options available.
<p>

<!----- Linking --- -->
<a name="link">
<p>
<h4>Linking PL/I programs</h4>
The following examples show different methods of linking PL/I programs.
<p>
This command uses gcc to link a PL/I program with libc, and use C's
malloc and free for heap storage management.
<table border=1 width="90%" align="center" bgcolor=#CCCC99>
<tr><td>
<tt><font face="Courier">
	gcc -o ${EXE} ${OBJ} ${ALTDIR}/fhs.o ${ALTDIR}/ghs.o -lprf -Wl,-M >${MAP}
</td></tr>
</table>
<ul>
<li>Replace ${EXE} with the name of your excecutable.
<li>Replace ${OBJ} with the name of your compiled object file (.o)
<li>Replace ${ALTDIR} with the name of the directory containing the alternate
storage management modules.
For example, the default is /pli-1.3.1/lib/alt
<li>Replace ${MAP} with the name of your link map (.map)
</ul>
<p>
This command uses gcc to link a PL/I program with libc, and use PL/I's heap storage management.
<table border=1 width="90%" align="center" bgcolor=#CCCC99>
<tr><td>
<tt><font face="Courier">
	gcc -o ${EXE} ${OBJ} -lprf -Wl,-M >${MAP}
</td></tr>
</table>
<ul>
<li>Replace ${EXE} with the name of your excecutable.
<li>Replace ${OBJ} with the name of your compiled object file (.o)
<li>Replace ${MAP} with the name of your link map (.map)
</ul>
<p>
This command uses ld to link a standalone PL/I program with no reference to libc.
<table border=1 width="90%" align="center" bgcolor=#CCCC99>
<tr><td>
<tt><font face="Courier">
	ld  -z muldefs -Bstatic -M  -e main -t -o ${EXE}        \
    	${OBJ}                                                  \
	-lprf                                                   \
	>${MAP}
</td></tr>
</table>
<ul>
<li>Replace ${EXE} with the name of your executable.
<li>Replace ${OBJ} with the name of your compiled object file (.o)
<li>Replace ${MAP} with the name of your link map (.map)
</ul>
<p>

<!-- --- 64-Bit -->
<a name="b64">
<p>
<h4>64-bit Linux Considerations</h4>
The Iron Spring PL/I compiler, and compiled PL/I programs, 
will run on a 64-bit system as 32-bit applications.
The following steps are required:
<ul>
<li>If ISAM is to be used, install the gnu 32-bit libc if not already installed. For Ubuntu-64 
the command is:<br>
<table border=1 width="90%" align="center" bgcolor=#CCCC99>
<tr><td>
<tt><font face="Courier">
sudo apt-get install gcc-multilib</font></tt>
</td></tr>
</table>
<li>The PL/I runtime library libprf.a should be placed in /usr/lib32.
<li>When linking with ld, the options required are:<br>
<table border=1 width="90%" align="center" bgcolor=#CCCC99>
<tr><td>
<pre>--oformat=elf32-i386
-melf_i386</pre></td></tr>
</table>
</ul>

<!----- Documentation --- -->
<a name="doc">
<p>
<h4>Documentation</h4>
The <a href="prog_guide.html"><i>Iron Spring PL/I Compiler Programming Guide</i></a> contains
a description of the features of the compiler.
Except as noted in the <i>Programming Guide</i> 
under <a href="prog_guide.html#diff">Compiler Differences</a> and
<a href="prog_guide.html#rest">Restrictions</a> this compiler is compatible with
the IBM "PL/I for MVS and VM Compiler 1.1".  A complete language reference will be available as part of a future release.
<p>
Documentation for the IBM compiler is available 
<a href="http://teampli.net/SC26-3114-01.pdf">online at teampli.net</a>.
<p>

<!-- --- Bugs fixed --- -->
<!-- ======================== Insert bug list here ==================== -->
<!-- Bug List  -->
<a name="fix">
<p>
<h4>Bugs Fixed</h4>
<!-- @include bug_list.html.skel -->
<table border=1 cellpadding=2 cellspacing=0>
<tr><th colspan=3>Cumulative list of bugs fixed</th></tr>
<tr><td valign="top"><td valign="top"><th>Changes in version 1.3.1</th></tr>
<tr><td valign="top">589<td valign="top">1.3.1<td>GOTO &lt;subscipted-label-constant&gt;
        traps at runtime
<tr><td valign="top">588<td valign="top">1.3.1<td>INITIAL attribute generates 
        incorrect data for STATIC BIT fields before non-BIT            
<tr><td valign="top">587<td valign="top">1.3.1<td>Incorrect conversion of
        CHARACTER to FLOAT             
<tr><td valign="top">584<td valign="top">1.3.1<td>Incorrect output PUT EDIT 
        with "F" format             
<tr><td valign="top">583<td valign="top">1.3.1<td>Incorrect output for PUT
        &lt;minor-structure&gt;             
<tr><td valign="top">579<td valign="top">1.3.1<td>Compiler trap on aggregate
        assignment of array arguments             
<tr><td valign="top">577<td valign="top">1.3.1<td>Alignment attribute not copied for 
        LIKE structure             
<tr><td valign="top">572<td valign="top">1.3.1<td>Compiler trap referencing
        computational elements of structure parameters             
<tr><td valign="top">571<td valign="top">1.3.1<td>Error returning bit(1)
        result from some conditionals            
<tr><td valign="top">570<td valign="top">1.3.1<td>SUM builtin of array with 
        zero lower bound causes runtime trap            
<tr><td valign="top">568<td valign="top">1.3.1<td>Reference to element of DEFINED 
        structure incorrect             
<tr><td valign="top">566<br>565<td>1.3.1<td>BIT builtin returns incorrect 
        result               
<tr><td valign="top">551<td valign="top">1.3.1<td>Structure qualification not allowed
        for refer object               
<tr><td valign="top">549<td valign="top">1.3.1<td>BASED AREA variable not properly
        initialized when allocated               
<tr><td valign="top">448<td valign="top">1.3.1<td>STRING builtin and pseudovariable 
        incorrect output if argument is a character string               
<tr><td valign="top">410<td valign="top">1.3.1<td>ONFILE builtin returns null
        string in UNDEFINEDFILE On-Unit               
<tr><td valign="top">344<td valign="top">1.3.1<td>GET STRING(xx) LIST(string) raises 
        ERROR condition                
<tr><td valign="top">231<td valign="top">1.3.1<td>ENTRY variable not allowed 
        as argument to ENTRYADDR builtin                  

<tr><td colspan=3>&nbsp;
<tr><td valign="top"><td valign="top"><th>Changes in prior versions</th></tr>
<tr><td valign="top">563<td valign="top">1.3.0<td>Incorrect access to elements of array
        of structures
<tr><td valign="top">561<td valign="top">1.3.0<td>Assignment to array of structures
        may be incorrect
<tr><td valign="top">560<td valign="top">1.3.0<td>Result of INDEX or SEARCH
        builtin incorrect if used in expression
<tr><td valign="top">556<td valign="top">1.3.0<td>LBOUND/HBOUND incorrect for
        adjustable array. (repeat of 320)
<tr><td valign="top">555<td valign="top">1.3.0<td>Refer object set incorrectly for
        array bounds
<tr><td valign="top">554<td valign="top">1.3.0<td>Incorrect length returned for
        CONTROLLED string elements
<tr><td valign="top">553<td valign="top">1.3.0<td>STORAGE/CURRENTSTORAGE values
        inconsistent for adjustable based structure
<tr><td valign="top">552<td valign="top">1.3.0<td>Refer expression not converted
        to FIXED BIN(31)
<tr><td valign="top">551<td valign="top">1.3.0<td>Allow structure qualification for 
        refer object name
<tr><td valign="top">550<td valign="top">1.3.0<td>Element name and descriptor not
        passed to I/O subsystem  
<tr><td valign="top">549<td valign="top">1.3.0<td>Subscripted reference to undeclared
        variable causes trap
<tr><td valign="top">548<td valign="top">1.3.0<td>Error with hardware shift instruction
        with constant shift amount 
<tr><td valign="top">547<td valign="top">1.3.0<td>Declaration of external array causes 
        compiler trap
<tr><td valign="top">540<td valign="top">1.3.0<td>No warning generated for undeclared
        programmer-named condition
<tr><td valign="top">530<td valign="top">1.3.0<td>TRIM(bit string) generates garbage
<tr><td valign="top">454<td valign="top">1.3.0<td>Error referencing BASED ENTRY variable
<tr><td valign="top">546<td valign="top">1.2.0<td>Builtin SIZE not recognized as 
        synonym for STORAGE
<tr><td valign="top">539<td valign="top">1.2.0<td>Incorrect conversion of bit string
        constant to FIXED DECIMAL 
<tr><td valign="top">536<td valign="top">1.2.0<td>Incorrect output with  
       PUT(bit_string) with A-Format  
<tr><td valign="top">534<td valign="top">1.2.0<td>Errors with UNSIGNED size<4 
<tr><td valign="top">533<td valign="top">1.2.0<td>Errors converting relational 
        expression to bit string 
<tr><td valign="top">532<td valign="top">1.1.0<td>(OS/2)GOTO out of 
ON-Unit causes erroneous "recursive abend"
<tr><td valign="top">528<td valign="top">1.1.0<td>Block initialization calling some
library procedures traps at runtime
<tr><td valign="top">518<td valign="top">1.1.0<td>Initialization of UNALIGNED
        BIT elements of STATIC structures and arrays incorrect
<tr><td valign="top">513<td valign="top">1.1.0<td>Various errors with VARYING 
UNALIGNED BIT arrays
<tr><td valign="top">512<td valign="top">1.1.0<td>Trap referencing structure with
REFER option declared in another block
<tr><td valign="top">511<td valign="top">1.1.0<td>Floating point numbers print incorrectly
if smaller than 1e-16
<tr><td valign="top">510<td valign="top">1.1.0<td>ADDR(x) may return incorrect result if
x was previously referenced in the same statement
<tr><td valign="top">509<td valign="top">1.1.0<td>Access to adjustable descriptor in
containing block returns incorrect result
<tr><td>461<br>462<td>1.1.0<td>SIGSEGV on aggregate assignment to 
array of structures
<tr><td valign="top">508<td valign="top">1.0.0<td>Incorrect conversion of FLOAT BINARY 
        to FIXED DECIMAL 
<tr><td valign="top">506<td valign="top">1.0.0<td>Compiler trap in some cases where 
        statement not properly terminated 
<tr><td valign="top">504<td valign="top">1.0.0<td>Incorrect conversion of COMPLEX data
<tr><td valign="top">503<td valign="top">1.0.0<td>Statement label should not be allowed
        on declaration 
<tr><td valign="top">502<td valign="top">1.0.0<td>Error using array element as control 
        variable in DO-Statement 
<tr><td valign="top">501<td valign="top">1.0.0<td>Code comment not printing subscript 
        for subscripted label constant 
<tr><td valign="top">500<td valign="top">1.0.0<td>GET/PUT array elements off by one 
<tr><td valign="top">499<td valign="top">1.0.0<td>CHAR to BIT conversion not handling
        leading and trailing blanks 
<tr><td valign="top">498<td valign="top">1.0.0<td>ONCHAR returns incorrect value 
<tr><td valign="top">497<td valign="top">1.0.0<td>Incorrect output for GET/PUT of 
        minor structure 
<tr><td valign="top">496<td valign="top">1.0.0<td>Problems moving FIXED BIN 
        returned value  
<tr><td valign="top">495<td valign="top">1.0.0<td>SIGNED/UNSIGNED builtins may return 
        incorrect precision 
<tr><td valign="top">494<td valign="top">1.0.0<td>Incorrect precision converting 
        FIXED DECIMAL to FIXED BINARY
<tr><td valign="top">493<td valign="top">1.0.0<td>Fixed documentation of OSGetProcInfo 
</table>
<!-- ======================== End of bug list ========================= -->

<!----- Runtime Library --- -->
<a name="lib">
<p>
<h4>Modifying the Runtime Library</h4>
The document <a href="library_linux.html">About the Iron Spring PL/I Library</a>
Contains information necessary to modify or extend the runtime library.
Most users of Iron Spring PL/I will probably not be interesting in making 
modifications to the library.
<p>

<!----- Bug Reports --- -->
<a name="bug">
<p>
<h4>Support</h4>
Iron Spring PL/I is supported on a "best efforts" basis. Attempts will be made
to fix all reported bugs, and have the fixes included in
the next distributed version.  "Thank You" to a number of users who have 
submitted bug reports which helped improve this version of the compiler.
<p>
The Iron Spring PL/I Users' Forum 
    (<a href="https://groups.io/g/Iron-Spring">https://groups.io/g/Iron-Spring</a>) 
 is available as a user forum for problems, tips, etc.  The developers also monitor
this group.
<p>
<h4>Reporting bugs</h4>
For the current version of the compiler, a <i>bug</i> 
is one of the following:
<ol>
<li>Any compiler trap.
<li>Incorrect output <b>not</b> caused by a flagged
unimplemented feature (compile-time message 995 or
run-time UNIMPLEMENTED condition.
<li>Compile-time message 990 (Compiler error).
<li>Output of the compiled program different from that produced
when the program is compiled with the IBM compiler, except for
differences noted.
</ol>
Features not implemented in the current version will
be added in future versions.  In the meantime, their
absence should at least be indicated by an error message.<p>
Before reporting a bug, please make sure you are running
the most recent release.
<p>The following information is <i>required</i> to report
a bug:
<ol>
<li>A brief description of the problem (trap, incorrect output, etc.)
<li>The host operating system: OS/2 or Linux.
<li>The command-line options used to compile this program.
<li>The current compiler version obtained by running <tt>plic -V</tt>
<li>A <i>small</i> sample program ilustrating the problem.  Please
make sure you imbed or supply all the %include files required to
compile the sample.
</ol>
Hopefully, all this information will be small enough to be sent as
plain text in a mail message.  Otherwise please attach a <b>zip</b> file.
No other formats will be accepted.
<p>
Mail bug reports to:<br>
<pre>   <a href="mailto:bugs@iron-spring.com?Subject=Version 1.3.1L">bugs@iron-spring.com</a>
<p>
<hr>
version 1.3.1, 15 Aug 2024<br>
<a href="http://www.iron-spring.com">http://www.iron-spring.com</a>


</html>
